<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>연결사 회원 정보 관리</title>
    <link rel="icon" type="image/png" sizes="32x32" href="image1.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="image1.png" />
    <link rel="apple-touch-icon" href="image1.png" />
    <meta property="og:image" content="image2.png" />
    <meta property="og:image:alt" content="연결사 상담 센터 대표 이미지" />
    <meta name="twitter:card" content="summary_large_image" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,400,0,0"
    />
    <meta name="twitter:image" content="image2.png" />
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />
        <link rel="stylesheet" href="dashboard.css" />
    <style>
      .detail-badge {
        display: none !important;
      }
    </style>

    <script src="backend-config.js"></script>
    <script src="firebase-config.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-storage-compat.js"></script>
  </head>
  <body class="auth-locked" data-app-variant="consult">
    <div id="authOverlay" class="auth-overlay" role="dialog" aria-modal="true">
      <form id="authForm" class="auth-dialog" novalidate>
        <h2>관리자 로그인</h2>
        <p>상담 대시보드를 확인하려면 관리자 계정으로 로그인해주세요.</p>
        <label>
          아이디
          <input id="authId" type="text" autocomplete="username" placeholder="아이디를 입력하세요" required />
        </label>
        <label>
          비밀번호
          <input
            id="authPassword"
            type="password"
            autocomplete="current-password"
            placeholder="비밀번호를 입력하세요"
            required
          />
        </label>
        <div id="authError" class="auth-error" role="alert" hidden>아이디 또는 비밀번호가 올바르지 않습니다.</div>
        <button type="submit">접속하기</button>
      </form>
    </div>
    <div id="appContent" hidden>
    <section class="stats-summary" aria-label="상담 현황">
      <div class="stats-header">
        <span class="section-label" id="statsSectionLabel">연결사 관리자 센터</span>
        <div class="stats-actions">
          <a class="variant-switch" id="variantSwitchBtn" href="index2.html">연결사 모임</a>
          <div class="quick-links">
        <a href="https://yeongyeolsa.imweb.me/admin/?type=page&_gl=1*zufqzi*_gcl_au*MTY3OTEyMjExNS4xNzYwNDk3ODM3LjE1NzI0MTM0ODIuMTc2MjE1NjIzNC4xNzYyMTU2Mjc1*_ga*NTAyMzEzOC4xNzYwNjc3MTc0*_ga_HP37L08LP3*czE3NjIxNTYyMjckbzYkZzEkdDE3NjIxNTYyNzgkajkkbDAkaDA.&_ga=2.97118614.820021611.1762135185-5023138.1760677174" target="_blank" rel="noopener noreferrer">Admin</a>
        <a href="https://ygsa.co.kr/" target="_blank" rel="noopener noreferrer">Website</a>
        <a href="https://www.notion.so/29ef5285ecb6807cb866c135f877c7a3?source=copy_link" target="_blank" rel="noopener noreferrer">Notion</a>
            <a href="https://dashboard.render.com/web/srv-d47j4nshg0os73fnnhd0/deploys/dep-d48ish3e5dus73c7t7ng" target="_blank" rel="noopener noreferrer">Render</a>
        <a href="https://github.com/wowonjin/ygsa" target="_blank" rel="noopener noreferrer">GitHub</a>
        <a href="https://console.firebase.google.com/u/0/project/ygsa-bee32/overview?hl=ko&fb_gclid=Cj0KCQiAxJXJBhD_ARIsAH_JGji1x4qCrSF6CNI5ryYncmLs0B2vwQ-HMa7gdO-X1PEPOBht3i3wXkcaAjzDEALw_wcB" target="_blank" rel="noopener noreferrer">Firebase</a>
      </div>
        </div>
      </div>
          <span id="statTotal">총 상담 인원: 0명</span>
          <span id="statMonthly">월간 상담 인원: 0명</span>
          <span id="statWeekly">주간 상담 인원: 0명</span>
          <span id="statDaily">오늘 상담 인원: 0명</span>
        </section>
    <section class="scheduler-panel" aria-label="신청 스케줄러">
      <div class="scheduler-head">
        <div class="scheduler-title-group">
          <div class="scheduler-title-row">
            <h3 id="schedulerTitle">신청 스케줄러</h3>
              <button type="button" id="calendarScrollBtn" class="scheduler-calendar-btn">
                <span class="material-symbols-rounded" aria-hidden="true">calendar_month</span>
                <span>캘린더 보기</span>
              </button>
              <button type="button" id="schedulerChartBtn" class="scheduler-calendar-btn">
                <span class="material-symbols-rounded" aria-hidden="true">stacked_bar_chart</span>
                <span>신청인원 보기</span>
              </button>
              <button type="button" id="monthlyRevenueBtn" class="scheduler-calendar-btn">
                <span class="material-symbols-rounded" aria-hidden="true">trending_up</span>
                <span>월간 매출 보기</span>
              </button>
          </div>
          <p id="schedulerSubtitle">최근 7일 신청 인원 흐름</p>
        </div>
        <span id="schedulerTotal" class="scheduler-total">0명</span>
      </div>
      <div id="schedulerGrid" class="scheduler-grid"></div>
        </section>
        <section class="toolbar" aria-label="필터">
          <div class="toolbar-header">
            <h3 class="toolbar-title">회원 목록</h3>
            <div class="gender-stats-wrap">
              <div class="gender-stats" id="genderStats" aria-live="polite">남 0명 · 여 0명 (0% : 0%)</div>
              <button type="button" id="genderChartBtn" class="gender-chart-btn">성비 보기</button>
              <button type="button" id="referralChartBtn" class="gender-chart-btn">유입 경로</button>
              <button type="button" id="matchBtn" class="match-btn">매칭하기</button>
              <button type="button" id="matchedCouplesBtn" class="matched-couples-btn">매칭된 커플</button>
            </div>
          </div>
          <div class="toolbar-filters">
            <input type="search" id="searchInput" placeholder="이름, 연락처, 신장, 직업 검색" aria-label="검색" />
            <select id="statusFilter" aria-label="상담 상태 필터">
              <option value="all">상담 상태 전체</option>
              <option value="pending">상담 전</option>
              <option value="scheduled">상담 예정</option>
              <option value="done">상담 완료</option>
            </select>
            <select id="genderFilter" aria-label="성별 필터">
              <option value="all">성별 전체</option>
            </select>
            <select id="districtFilter" aria-label="지역 필터">
              <option value="all">지역 전체</option>
            </select>
            <select id="sortSelect" aria-label="정렬">
              <option value="latest">최신 순</option>
              <option value="oldest">오래된 순</option>
              <option value="name">이름 순</option>
              <option value="height">신장 순</option>
            </select>
              <button type="button" id="exportBtn">엑셀로 내보내기</button>
              <button type="button" id="importBtn">엑셀에서 불러오기</button>
              <input type="file" id="excelInput" accept=".xlsx,.xls" hidden />
          </div>
        </section>
        <main>
          <section id="cardsContainer" class="cards"></section>
          <div id="emptyState" class="empty" hidden>아직 접수된 상담 신청이 없습니다.</div>
        </main>
    <div id="toast" class="toast">새로운 상담 신청이 도착했습니다!</div>
    <div class="calendar-overlay" id="calendarModal" hidden>
      <div class="calendar-dialog">
        <header>
          <h2>대면 상담 캘린더</h2>
          <button type="button" class="close" id="calendarCloseBtn" aria-label="닫기">×</button>
        </header>
        <div class="calendar-controls">
          <div class="calendar-nav">
            <button type="button" id="calendarPrevBtn" aria-label="이전 달">◀</button>
            <h3 id="calendarCurrentMonth">2025년 1월</h3>
            <button type="button" id="calendarNextBtn" aria-label="다음 달">▶</button>
          </div>
          <button type="button" id="calendarTodayBtn" class="calendar-today">오늘</button>
        </div>
        <div class="calendar-layout">
          <div class="calendar-grid" id="calendarGrid" role="grid"></div>
          <aside class="calendar-panel">
            <h4 id="calendarSelectedTitle">선택된 일정</h4>
            <ul id="calendarAppointmentList" class="calendar-appointments"></ul>
          </aside>
        </div>
      </div>
    </div>
    <div class="simple-modal-overlay" id="schedulerChartModal" hidden>
      <div class="simple-modal">
        <header class="simple-modal-header">
          <h3>최근 7일 그래프</h3>
          <button type="button" id="schedulerChartCloseBtn" aria-label="그래프 모달 닫기">×</button>
        </header>
        <div class="referral-chart-body scheduler-chart-body">
          <p class="referral-chart-summary" id="schedulerChartSummary">전체 기간 일별/누적 신청 인원 추이를 확인하세요.</p>
          <div
            id="schedulerChartGraph"
            class="scheduler-chart-graph"
            role="img"
            aria-label="전체 기간 신청 인원 선 그래프"
          ></div>
          <div class="scheduler-chart-legend">
            <span class="legend-dot is-count" aria-hidden="true"></span>
            <span>일별 신청 인원</span>
            <span class="legend-dot is-cumulative" aria-hidden="true"></span>
            <span>누적 인원</span>
            <span class="scheduler-chart-today" id="schedulerChartTodayLabel"></span>
          </div>
        </div>
      </div>
    </div>
    <div class="simple-modal-overlay" id="monthlyRevenueModal" hidden>
      <div class="simple-modal revenue-chart-modal">
        <header class="simple-modal-header">
          <h3>월간 매출 현황</h3>
          <button type="button" id="monthlyRevenueCloseBtn" aria-label="매출 모달 닫기">×</button>
        </header>
        <div class="revenue-chart-body">
          <p id="monthlyRevenueSummary" class="revenue-chart-summary">회원 결제 내역을 월별로 집계합니다.</p>
          <div
            id="monthlyRevenueGraph"
            class="revenue-chart-graph"
            role="img"
            aria-label="월별 매출 선 그래프"
          ></div>
          <div class="revenue-chart-legend">
            <span class="legend-dot is-count" aria-hidden="true"></span>
            <span>월별 매출</span>
            <span class="legend-dot is-cumulative" aria-hidden="true"></span>
            <span>누적 매출</span>
          </div>
          <ul id="monthlyRevenueList" class="revenue-chart-list"></ul>
          <p id="monthlyRevenueEmpty" class="revenue-chart-empty" hidden>표시할 데이터가 없습니다.</p>
        </div>
      </div>
    </div>
    <div class="modal-overlay" id="detailModal" hidden>
      <div class="modal-content">
        <form id="detailForm" class="modal-form">
          <div class="modal-header">
            <div class="modal-title-group">
              <h2 id="detailTitle">상세 정보</h2>
              <p class="modal-subtitle" id="detailSubtitle"></p>
            </div>
            <div class="modal-actions">
              <button type="button" class="secondary" id="detailDraftLoadBtn" hidden>임시 데이터 불러오기</button>
              <button type="button" class="secondary" id="detailCancelBtn">취소</button>
              <button type="submit" class="primary">저장</button>
            </div>
          </div>
          <div class="detail-priority" aria-label="상담 진행 상태">
            <hr class="detail-divider" />
            <div class="field">
              <label for="detailPhoneStatus">전화 상담 상태</label>
              <select id="detailPhoneStatus">
                <option value="pending">상담 전</option>
                <option value="scheduled">상담 예정</option>
                <option value="done">상담 완료</option>
              </select>
            </div>
            <div class="field span-2">
              <label>대면 상담 일정 (15분 단위)</label>
              <div class="inline-group">
                <input type="date" id="detailDate" />
                <select id="detailTime" class="time-select" disabled>
                  <option value="">시간 선택</option>
                </select>
                <button type="button" id="detailClearSchedule" aria-label="일정 초기화">🗑</button>
              </div>
              <p class="modal-subtitle" id="detailScheduleInfo"></p>
            </div>
            <hr class="detail-divider" />
          </div>
          <div class="detail-section-tabs" role="tablist" aria-label="상세 정보 카테고리">
            <button
              type="button"
              class="detail-section-tab"
              data-detail-section-target="basic"
              aria-controls="detailSectionBasic"
              role="tab"
              aria-selected="false"
            >
              기본 정보
            </button>
            <button
              type="button"
              class="detail-section-tab"
              data-detail-section-target="profile"
              aria-controls="detailSectionProfile"
              role="tab"
              aria-selected="false"
            >
              세부 프로필
            </button>
            <button
              type="button"
              class="detail-section-tab"
              data-detail-section-target="lifestyle"
              aria-controls="detailSectionLifestyle"
              role="tab"
              aria-selected="false"
            >
              라이프스타일
            </button>
            <button
              type="button"
              class="detail-section-tab"
              data-detail-section-target="preference"
              aria-controls="detailSectionPreference"
              role="tab"
              aria-selected="false"
            >
              선호 조건
            </button>
            <button
              type="button"
              class="detail-section-tab"
              data-detail-section-target="notes"
              aria-controls="detailSectionNotes"
              role="tab"
              aria-selected="false"
            >
              관리자 메모
            </button>
            <button
              type="button"
              class="detail-section-tab"
              data-detail-section-target="feedback"
              aria-controls="detailSectionFeedback"
              role="tab"
              aria-selected="false"
            >
              만남 후기
            </button>
            <button
              type="button"
              class="detail-section-tab"
              data-detail-section-target="attachments"
              aria-controls="detailAttachmentsSection"
              role="tab"
              aria-selected="false"
              aria-disabled="true"
              disabled
            >
              증빙 자료
            </button>
            <button
              type="button"
              class="detail-section-tab"
              data-detail-section-target="payments"
              aria-controls="detailSectionPayments"
              role="tab"
              aria-selected="false"
            >
              결제 내역
            </button>
          </div>
          <div class="detail-section-group" aria-live="polite">
            <fieldset
              class="detail-section detail-section-basic"
              id="detailSectionBasic"
              data-detail-section="basic"
              hidden
            >
              <legend>기본 정보</legend>
              <div class="detail-field-grid columns-3">
                <div class="field">
                  <label for="detailName">성명</label>
                  <input id="detailName" type="text" autocomplete="name" required />
                </div>
                <div class="field">
                  <label for="detailGender">성별</label>
                  <select id="detailGender" required>
                    <option value="">선택</option>
                    <option value="남">남자</option>
                    <option value="여">여자</option>
                  </select>
                </div>
                <div class="field">
                  <label for="detailBirth">생년</label>
                  <input
                    id="detailBirth"
                    type="text"
                    inputmode="numeric"
                    maxlength="6"
                    placeholder="1998년"
                    required
                  />
                </div>
                <div class="field">
                  <label for="detailPhone">연락처</label>
                  <input
                    id="detailPhone"
                    type="tel"
                    inputmode="tel"
                    autocomplete="tel-national"
                    placeholder="010-1234-5678"
                    required
                  />
                </div>
                <div class="field">
                  <label for="detailHeight">신장</label>
                  <input
                    id="detailHeight"
                    type="text"
                    inputmode="numeric"
                    maxlength="5"
                    placeholder="170cm"
                    required
                  />
                </div>
                <div class="field">
                  <label for="detailEducation">최종학력</label>
                  <select id="detailEducation" required>
                    <option value="">선택</option>
                    <optgroup label="고등교육 이전">
                      <option>고등학교 재학</option>
                      <option>고등학교 졸업(검정고시 포함)</option>
                    </optgroup>
                    <optgroup label="전문대(2·3년)">
                      <option>전문대 재학</option>
                      <option>전문학사 졸업</option>
                    </optgroup>
                    <optgroup label="대학교(4년)">
                      <option>대학교 재학(4년)</option>
                      <option>학사 졸업</option>
                    </optgroup>
                    <optgroup label="대학원">
                      <option>석사 과정 재학</option>
                      <option>석사 졸업</option>
                      <option>박사 과정 재학</option>
                      <option>박사 졸업</option>
                    </optgroup>
                    <optgroup label="기타">
                      <option>해외 대학 재학/졸업</option>
                      <option>기타</option>
                    </optgroup>
                  </select>
                </div>
                <div class="field">
                  <label for="detailDistrict">거주 구</label>
                  <input id="detailDistrict" type="text" placeholder="서울특별시 강남구" required />
                </div>
                <div class="field">
                  <label for="detailReferralSource">유입 경로</label>
                  <select id="detailReferralSource">
                    <option value="">선택</option>
                    <option value="쓰레드">쓰레드</option>
                    <option value="프립">프립</option>
                    <option value="지인 추천">지인 추천</option>
                    <option value="문토">문토</option>
                    <option value="인스타그램">인스타그램</option>
                    <option value="네이버블로그">네이버블로그</option>
                    <option value="기타/미입력">기타/미입력</option>
                  </select>
                </div>
              </div>
              <div class="detail-field-grid columns-3 detail-form-field-grid">
                <div class="field">
                  <label for="detailJob">
                    <span class="form-label">Form</span>
                    직업/직무
                    <span class="detail-badge detail-badge-public" aria-hidden="true">공개</span>
                  </label>
                  <input
                    id="detailJob"
                    type="text"
                    placeholder="예: 중견 무역회사 해외영업"
                    autocomplete="organization"
                    required
                  />
                </div>
                <div class="field">
                  <label for="detailJobDetail">
                    <span class="form-label">Form</span>
                    직업/직무 상세
                    <span class="detail-badge detail-badge-public" aria-hidden="true">공개</span>
                  </label>
                  <input
                    id="detailJobDetail"
                    type="text"
                    placeholder="예: 중견 무역회사 해외영업팀에서 북미 시장 담당"
                  />
                </div>
                <div class="field">
                  <label for="detailMbti">
                    <span class="form-label">Form</span>
                    MBTI
                    <span class="detail-badge detail-badge-public" aria-hidden="true">공개</span>
                  </label>
                  <input id="detailMbti" type="text" placeholder="예: ENFP" />
                </div>
                <div class="field">
                  <label for="detailUniversity">
                    <span class="form-label">Form</span>
                    대학교
                    <span class="detail-badge detail-badge-match" aria-hidden="true">매칭 후 공개</span>
                  </label>
                  <input id="detailUniversity" type="text" placeholder="예: 서울대학교 (관악캠퍼스)" />
                </div>
                <div class="field">
                  <label for="detailSalaryRange">
                    <span class="form-label">Form</span>
                    연봉 (세전 기준)
                    <span class="detail-badge detail-badge-match" aria-hidden="true">매칭 후 공개</span>
                  </label>
                  <select id="detailSalaryRange">
                    <option value="">선택</option>
                    <option value="1">1) 3000만원 미만</option>
                    <option value="2">2) 3000-4000</option>
                    <option value="3">3) 4000-6000</option>
                    <option value="4">4) 6000-8000</option>
                    <option value="5">5) 8000-1억</option>
                    <option value="6">6) 1억-2억</option>
                    <option value="7">7) 2억-3억</option>
                    <option value="8">8) 3억 이상</option>
                  </select>
                </div>
                <div class="field">
                  <label for="detailSmoking">
                    <span class="form-label">Form</span>
                    흡연
                    <span class="detail-badge detail-badge-public" aria-hidden="true">공개</span>
                  </label>
                  <select id="detailSmoking">
                    <option value="">선택</option>
                    <option value="비흡연">비흡연</option>
                    <option value="사회적 흡연">사회적 흡연</option>
                    <option value="흡연">흡연</option>
                  </select>
                </div>
                <div class="field">
                  <label for="detailReligion">
                    <span class="form-label">Form</span>
                    종교
                    <span class="detail-badge detail-badge-match" aria-hidden="true">매칭 후 공개</span>
                  </label>
                  <select id="detailReligion">
                    <option value="">선택</option>
                    <option value="무교">무교</option>
                    <option value="기독교">기독교</option>
                    <option value="천주교">천주교</option>
                    <option value="불교">불교</option>
                    <option value="기타">기타</option>
                  </select>
                </div>
              </div>
            </fieldset>

            <fieldset
              class="detail-section detail-section-profile"
              id="detailSectionProfile"
              data-detail-section="profile"
              hidden
            >
              <legend>세부 프로필</legend>
              <div class="detail-field-grid columns-2">
                <div class="field full-width">
                  <label for="detailProfileAppeal">
                    추가 어필
                    <span class="detail-badge detail-badge-public" aria-hidden="true">공개</span>
                  </label>
                  <textarea
                    id="detailProfileAppeal"
                    placeholder="연봉, 자산, 학력 등 프로필에 강조하고 싶은 내용을 적어주세요."
                  ></textarea>
                </div>
                <div class="field full-width">
                  <label for="detailAboutMe">
                    '저는 이런 사람입니다'
                    <span class="detail-badge detail-badge-public" aria-hidden="true">공개</span>
                  </label>
                  <textarea
                    id="detailAboutMe"
                    placeholder="어필할 수 있는 매력포인트나 성격을 적어주세요."
                  ></textarea>
                </div>
                <div class="field full-width">
                  <label for="detailSufficientCondition">
                    충분조건
                    <span class="detail-badge detail-badge-public" aria-hidden="true">공개</span>
                  </label>
                  <textarea
                    id="detailSufficientCondition"
                    placeholder="충분조건을 입력해주세요."
                  ></textarea>
                </div>
                <div class="field full-width">
                  <label for="detailNecessaryCondition">
                    필요조건
                    <span class="detail-badge detail-badge-public" aria-hidden="true">공개</span>
                  </label>
                  <textarea
                    id="detailNecessaryCondition"
                    placeholder="필요조건을 입력해주세요."
                  ></textarea>
                </div>
                <div class="field full-width">
                  <label for="detailLikesDislikes">
                    좋아하는 것 / 싫어하는 것
                    <span class="detail-badge detail-badge-match" aria-hidden="true">매칭 후 공개</span>
                  </label>
                  <textarea
                    id="detailLikesDislikes"
                    placeholder="좋아하는 것과 싫어하는 것을 적어주세요."
                  ></textarea>
                </div>
              </div>
            </fieldset>

            <fieldset
              class="detail-section detail-section-lifestyle"
              id="detailSectionLifestyle"
              data-detail-section="lifestyle"
              hidden
            >
              <legend>관계 및 라이프스타일</legend>
              <div class="detail-field-grid columns-3">
                <div class="field">
                  <label for="detailTattoo">
                    문신 여부
                    <span class="detail-badge detail-badge-public" aria-hidden="true">공개</span>
                  </label>
                  <select id="detailTattoo">
                    <option value="">선택</option>
                    <option value="문신 없음">문신 없음</option>
                    <option value="문신 있음">문신 있음</option>
                    <option value="비공개">비공개</option>
                  </select>
                </div>
                <div class="field">
                  <label for="detailCarOwnership">
                    자차 유무
                    <span class="detail-badge detail-badge-public" aria-hidden="true">공개</span>
                  </label>
                  <select id="detailCarOwnership">
                    <option value="">선택</option>
                    <option value="있음">있음</option>
                    <option value="없음">없음</option>
                    <option value="구입 계획 있음">구입 계획 있음</option>
                  </select>
                </div>
                <div class="field">
                  <label for="detailLongDistance">장거리 연애 가능 여부</label>
                  <select id="detailLongDistance">
                    <option value="">선택</option>
                    <option value="가능">가능</option>
                    <option value="불가능">불가능</option>
                    <option value="상황에 따라">상황에 따라</option>
                  </select>
                </div>
                <div class="field">
                  <label for="detailLastRelationship">
                    마지막 연애 시기
                    <span class="detail-badge detail-badge-match" aria-hidden="true">매칭 후 공개</span>
                  </label>
                  <input
                    id="detailLastRelationship"
                    type="text"
                    placeholder="예: 2024년 5쯤 이별"
                  />
                </div>
                <div class="field">
                  <label for="detailRelationshipCount">
                    성인 후 연애 횟수
                    <span class="detail-badge detail-badge-match" aria-hidden="true">매칭 후 공개</span>
                  </label>
                  <select id="detailRelationshipCount">
                    <option value="">선택</option>
                    <option value="0회">0회</option>
                    <option value="1~3회">1~3회</option>
                    <option value="4~6회">4~6회</option>
                    <option value="7~9회">7~9회</option>
                    <option value="10~12회">10~12회</option>
                    <option value="13~15회">13~15회</option>
                    <option value="16~19회">16~19회</option>
                    <option value="20회 이상">20회 이상</option>
                  </select>
                </div>
                <div class="field">
                  <label for="detailDivorceStatus">돌싱 여부</label>
                  <select id="detailDivorceStatus">
                    <option value="">선택</option>
                    <option value="돌싱입니다(자녀o)">돌싱입니다(자녀o)</option>
                    <option value="돌싱입니다(자녀x)">돌싱입니다(자녀x)</option>
                    <option value="돌싱이 아닙니다">돌싱이 아닙니다</option>
                  </select>
                </div>
              </div>
            </fieldset>

            <fieldset
              class="detail-section detail-section-preference"
              id="detailSectionPreference"
              data-detail-section="preference"
              hidden
            >
              <legend>선호 조건</legend>
              <div class="detail-field-grid columns-3">
                <div class="field field-range">
                  <label for="detailPreferredHeightMin" id="detailPreferredHeightsLabel">
                    선호하는 키
                    <span class="detail-badge detail-badge-preference" aria-hidden="true">매칭용</span>
                    <span class="select-hint">범위를 입력해주세요</span>
                  </label>
                  <div class="range-inputs">
                    <input
                      type="text"
                      id="detailPreferredHeightMin"
                      inputmode="numeric"
                      placeholder="폼1 예: 175cm"
                      aria-describedby="detailPreferredHeightHint"
                    />
                    <span class="range-separator" aria-hidden="true">~</span>
                    <input
                      type="text"
                      id="detailPreferredHeightMax"
                      inputmode="numeric"
                      placeholder="폼2 예: 180cm"
                      aria-describedby="detailPreferredHeightHint"
                    />
                  </div>
                </div>
                <div class="field field-range">
                  <label for="detailPreferredAgeYoungest" id="detailPreferredAgesLabel">
                    선호 나이
                    <span class="detail-badge detail-badge-preference" aria-hidden="true">매칭용</span>
                    <span class="select-hint">범위를 입력해주세요</span>
                  </label>
                  <div class="range-inputs">
                    <input
                      type="text"
                      id="detailPreferredAgeYoungest"
                      inputmode="numeric"
                      placeholder="폼1 예: 97년생"
                      aria-describedby="detailPreferredAgeHint"
                    />
                    <span class="range-separator" aria-hidden="true">~</span>
                    <input
                      type="text"
                      id="detailPreferredAgeOldest"
                      inputmode="numeric"
                      placeholder="폼2 예: 93년생"
                      aria-describedby="detailPreferredAgeHint"
                    />
                  </div>
                </div>
                <div class="field">
                  <label for="detailPreferredAppearance">
                    선호하는 외적 이상형
                    <span class="detail-badge detail-badge-preference" aria-hidden="true">매칭용</span>
                  </label>
                  <select id="detailPreferredAppearance">
                    <option value="">선택</option>
                    <option value="깔끔하고 단정한 스타일">깔끔하고 단정한 스타일</option>
                    <option value="세련된 도시 감성">세련된 도시 감성</option>
                    <option value="스포티하고 건강한 스타일">스포티하고 건강한 스타일</option>
                    <option value="캐주얼하고 편안한 분위기">캐주얼하고 편안한 분위기</option>
                    <option value="러블리하고 부드러운 인상">러블리하고 부드러운 인상</option>
                    <option value="개성 있는 패션 감각">개성 있는 패션 감각</option>
                    <option value="상관없음">상관없음</option>
                  </select>
                </div>
                <div class="field">
                  <label for="detailDink">
                    딩크 여부
                    <span class="detail-badge detail-badge-preference" aria-hidden="true">매칭용</span>
                  </label>
                  <select id="detailDink">
                    <option value="">선택</option>
                    <option value="딩크를 원합니다">딩크를 원합니다</option>
                    <option value="딩크를 고려 중입니다">딩크를 고려 중입니다</option>
                    <option value="딩크를 원하지 않습니다">딩크를 원하지 않습니다</option>
                  </select>
                </div>
                <div class="field">
                  <label for="detailMarriageTiming">
                    결혼을 생각하는 시기
                    <span class="detail-badge detail-badge-preference" aria-hidden="true">매칭용</span>
                  </label>
                  <select id="detailMarriageTiming">
                    <option value="">선택</option>
                    <option value="상대방에 따라 다름">상대방에 따라 다름</option>
                    <option value="결혼생각 없음">결혼생각 없음</option>
                    <option value="연애 시작 후 3개월 안에 결혼준비 시작">
                      연애 시작 후 3개월 안에 결혼준비 시작
                    </option>
                    <option value="연애 시작 후 6개월 안에 결혼준비 시작">
                      연애 시작 후 6개월 안에 결혼준비 시작
                    </option>
                    <option value="연애 시작 후 1년 정도에 결혼준비 시작">
                      연애 시작 후 1년 정도에 결혼준비 시작
                    </option>
                    <option value="연애 시작 후 1년 6개월 정도에 결혼준비 시작">
                      연애 시작 후 1년 6개월 정도에 결혼준비 시작
                    </option>
                    <option value="연애 시작 후 2년정도에 결혼준비 시작">
                      연애 시작 후 2년정도에 결혼준비 시작
                    </option>
                    <option value="연애 시작 후 2년 이상에 결혼준비 시작">
                      연애 시작 후 2년 이상에 결혼준비 시작
                    </option>
                  </select>
                </div>
                <div class="field">
                  <label for="detailPreferredLifestyle" id="detailPreferredLifestyleLabel">
                    선호 라이프스타일
                    <span class="detail-badge detail-badge-preference" aria-hidden="true">매칭용</span>
                    <span class="select-hint">여러 항목 선택 가능</span>
                  </label>
                  <div
                    class="multi-checkbox-list"
                    data-multi-select="detailPreferredLifestyle"
                    role="group"
                    aria-labelledby="detailPreferredLifestyleLabel"
                  >
                    <label class="multi-checkbox-item">
                      <input type="checkbox" value="활동적인 야외 취미" />
                      <span>활동적인 야외 취미</span>
                    </label>
                    <label class="multi-checkbox-item">
                      <input type="checkbox" value="집중적인 자기계발" />
                      <span>집중적인 자기계발</span>
                    </label>
                    <label class="multi-checkbox-item">
                      <input type="checkbox" value="집에서 휴식하기" />
                      <span>집에서 휴식하기</span>
                    </label>
                    <label class="multi-checkbox-item">
                      <input type="checkbox" value="여행과 새로운 경험" />
                      <span>여행과 새로운 경험</span>
                    </label>
                    <label class="multi-checkbox-item">
                      <input type="checkbox" value="문화·예술 감상" />
                      <span>문화·예술 감상</span>
                    </label>
                    <label class="multi-checkbox-item">
                      <input type="checkbox" value="운동·건강 관리" />
                      <span>운동·건강 관리</span>
                    </label>
                    <label class="multi-checkbox-item">
                      <input type="checkbox" value="미식·카페 탐방" />
                      <span>미식·카페 탐방</span>
                    </label>
                    <label class="multi-checkbox-item">
                      <input type="checkbox" value="반려동물과 함께" />
                      <span>반려동물과 함께</span>
                    </label>
                  </div>
                  <select
                    id="detailPreferredLifestyle"
                    multiple
                    size="8"
                    class="multi-select-hidden"
                    aria-hidden="true"
                    tabindex="-1"
                  >
                    <option value="활동적인 야외 취미">활동적인 야외 취미</option>
                    <option value="집중적인 자기계발">집중적인 자기계발</option>
                    <option value="집에서 휴식하기">집에서 휴식하기</option>
                    <option value="여행과 새로운 경험">여행과 새로운 경험</option>
                    <option value="문화·예술 감상">문화·예술 감상</option>
                    <option value="운동·건강 관리">운동·건강 관리</option>
                    <option value="미식·카페 탐방">미식·카페 탐방</option>
                    <option value="반려동물과 함께">반려동물과 함께</option>
                  </select>
                </div>
              </div>
            </fieldset>

            <fieldset
              class="detail-section detail-section-notes"
              id="detailSectionNotes"
              data-detail-section="notes"
              hidden
            >
              <legend>관리자 메모</legend>
              <div class="detail-field-grid">
                <div class="field full-width detail-notes">
                  <label for="detailNotes">관리자 메모</label>
                  <textarea id="detailNotes" placeholder="상담 기록이나 참고 사항을 입력하세요."></textarea>
                </div>
              </div>
            </fieldset>
            <fieldset
              class="detail-section detail-section-feedback"
              id="detailSectionFeedback"
              data-detail-section="feedback"
              hidden
            >
              <legend>만남 후기 &amp; 매칭 평점</legend>
              <div class="detail-field-grid">
                <div class="field full-width detail-match-feedback">
                  <div class="match-feedback-form" id="matchFeedbackForm">
                    <div class="match-feedback-form-grid">
                      <label>
                        회차
                        <input
                          id="matchFeedbackRound"
                          type="text"
                          placeholder="예: 1회차"
                          autocomplete="off"
                        />
                      </label>
                      <label>
                        평점
                        <select id="matchFeedbackRating">
                          <option value="">선택</option>
                          <option value="1">1점</option>
                          <option value="2">2점</option>
                          <option value="3">3점</option>
                          <option value="4">4점</option>
                          <option value="5">5점</option>
                        </select>
                      </label>
                      <label>
                        상대 이름
                        <input
                          id="matchFeedbackPartner"
                          type="text"
                          placeholder="예: 김연결"
                          autocomplete="off"
                        />
                      </label>
                    </div>
                    <label class="match-feedback-form-note">
                      후기
                      <textarea
                        id="matchFeedbackNote"
                        rows="3"
                        placeholder="만남 기록을 입력해주세요."
                      ></textarea>
                    </label>
                    <div class="match-feedback-form-actions">
                      <button type="button" id="matchFeedbackSaveBtn" class="match-feedback-save-btn">
                        저장
                      </button>
                    </div>
                  </div>
                  <div class="match-feedback-history-wrap">
                    <h4 class="match-feedback-history-title">저장된 후기</h4>
                    <ul id="matchFeedbackList" class="match-feedback-history" aria-live="polite"></ul>
                    <p id="matchFeedbackEmpty" class="match-feedback-empty" hidden>
                      아직 저장된 후기가 없습니다.
                    </p>
                  </div>
                </div>
              </div>
            </fieldset>
            <fieldset
              class="detail-section detail-section-payments"
              id="detailSectionPayments"
              data-detail-section="payments"
              hidden
            >
              <legend>결제 내역</legend>
          <div class="membership-payment-field">
            <p id="detailPaymentTotal" class="payment-total-amount">총 결제 금액 0원</p>
            <label class="membership-payment-label" for="detailMembershipType">회원권 / 결제 정보</label>
            <div class="inline-group membership-payment-inline">
              <select id="detailMembershipType" aria-label="회원권 종류">
                <option value="">회원권 선택</option>
                <option value="라이트">라이트</option>
                <option value="스탠다드">스탠다드</option>
                <option value="프리미엄">프리미엄</option>
              </select>
              <input
                id="detailPaymentAmount"
                type="text"
                inputmode="numeric"
                placeholder="결제 대금 (원)"
                aria-label="결제 대금"
              />
              <div class="payment-date-add">
                <input id="detailPaymentDate" type="date" aria-label="입금 날짜" />
                <button type="button" id="detailPaymentAddBtn" class="payment-add-btn">추가하기</button>
              </div>
            </div>
          </div>
              <ul id="paymentHistoryList" class="payment-history-list" aria-live="polite"></ul>
              <p id="paymentHistoryEmpty" class="payment-history-empty" hidden>저장된 결제 내역이 없습니다.</p>
            </fieldset>
          </div>
          <section
            class="detail-attachments"
            id="detailAttachmentsSection"
            data-detail-section="attachments"
            hidden
          >
            <h3>증빙 자료 및 사진</h3>
            <div class="attachment-upload-controls" id="detailPhotoUploadControls">
              <p class="attachment-upload-hint">증빙 자료와 사진은 Firebase Storage에 저장되며 파일당 최대 10MB까지 지원됩니다.</p>
              <div class="attachment-upload-buttons">
                <button type="button" id="detailIdCardUploadBtn">신분증 업로드</button>
                <button type="button" id="detailEmploymentUploadBtn">재직 증빙 업로드</button>
                <button type="button" id="detailPhotoFaceBtn">얼굴 사진 업로드</button>
                <button type="button" id="detailPhotoFullBtn">전신 사진 업로드</button>
              </div>
              <input type="file" id="detailIdCardUploadInput" accept="image/*,.pdf" hidden />
              <input type="file" id="detailEmploymentUploadInput" accept="image/*,.pdf" hidden />
              <input type="file" id="detailPhotoFaceInput" accept="image/*" multiple hidden />
              <input type="file" id="detailPhotoFullInput" accept="image/*" multiple hidden />
              <p id="detailAttachmentUploadStatus" class="attachment-upload-status" aria-live="polite"></p>
            </div>
            <div class="attachment-items">
              <div class="attachment-item" id="detailIdCardItem" hidden>
                <div class="attachment-item-head">
                  <h4>신분증</h4>
                  <button
                    type="button"
                    class="attachment-delete-btn"
                    id="detailIdCardDeleteBtn"
                    data-attachment-type="document"
                    data-attachment-key="idCard"
                    hidden
                  >
                    삭제
                  </button>
                </div>
                <a id="detailIdCardLink" href="#" download>다운로드</a>
              </div>
              <div class="attachment-item" id="detailEmploymentItem" hidden>
                <div class="attachment-item-head">
                  <h4>재직 증빙</h4>
                  <button
                    type="button"
                    class="attachment-delete-btn"
                    id="detailEmploymentDeleteBtn"
                    data-attachment-type="document"
                    data-attachment-key="employmentProof"
                    hidden
                  >
                    삭제
                  </button>
                </div>
                <a id="detailEmploymentLink" href="#" download>다운로드</a>
              </div>
              <div class="attachment-item" id="detailPhotosItem" hidden>
                <h4>프로필 사진</h4>
                <div class="attachment-photo-grid" id="detailPhotosGrid"></div>
              </div>
            </div>
          </section>
        </form>
      </div>
    </div>
    <div class="bulk-action-bar" id="bulkActionBar" hidden>
      <span id="selectionInfo"></span>
      <button type="button" id="deleteSelectedBtn">정보 삭제하기</button>
    </div>
    <button type="button" class="note-toggle" id="noteToggleBtn" aria-controls="stickyNote" aria-expanded="false">메모</button>
    <div class="sticky-note" id="stickyNote" hidden>
        <button type="button" class="sticky-note-close" id="stickyNoteCloseBtn" aria-label="메모 닫기">×</button>
      <div class="sticky-note-body">
        [아임웹 아이디 비번 비밀번호] <br />
        ID: yeongyeolsa@gmail.com <br />
        PS: 10Aksghldnjs!
        <br /><br />
        [구글 아이디 비번 비밀번호] <br />
        ID: yeongyeolsa@gmail.com <br />
        PS: 10aksghldnjs
      </div>
    </div>
    <div class="match-overlay" id="matchModal" hidden>
      <div class="match-dialog" role="dialog" aria-modal="true" aria-labelledby="matchModalTitle">
        <header class="match-header">
          <div>
            <h3 id="matchModalTitle">맞춤 매칭 프로그램</h3>
            <p class="match-subtitle">Ctrl + Q로도 바로 열 수 있어요.</p>
          </div>
          <button type="button" id="matchCloseBtn" class="match-close-btn" aria-label="매칭 창 닫기">×</button>
        </header>
        <div class="match-body">
          <section class="match-left">
            <div class="match-field-group">
              <label for="matchTargetInput">대상자</label>
              <div class="match-input-row">
                <input
                  id="matchTargetInput"
                  type="text"
                  list="matchMemberOptions"
                  placeholder="이름, 연락처 검색"
                  autocomplete="off"
                />
                <button type="button" id="matchResetBtn" class="match-reset-btn" hidden aria-label="대상자 초기화">
                  <span class="material-symbols-rounded" aria-hidden="true">delete</span>
                </button>
              </div>
              <datalist id="matchMemberOptions"></datalist>
            </div>
            <div id="matchTargetInfo" class="match-target-card">
              <p class="match-placeholder">대상자를 선택하면 기본 정보와 선호 조건이 표시됩니다.</p>
            </div>
            <div class="match-conditions inline">
              <h4>선호 조건 요약</h4>
              <div class="match-condition-grid">
                <div>
                  <span class="label">키</span>
                  <div id="matchPreferredHeight" class="value">-</div>
                </div>
                <div>
                  <span class="label">나이</span>
                  <div id="matchPreferredAge" class="value">-</div>
                </div>
                <div class="full">
                  <span class="label">라이프스타일</span>
                  <div id="matchPreferredLifestyle" class="value match-chip-row">-</div>
                </div>
              </div>
            </div>
            <div class="match-selection-panel">
              <div class="match-selection-head">
                <h4>선택된 후보</h4>
                <span id="matchSelectionCount">0명</span>
              </div>
              <div class="match-selection-tools" aria-label="소개 주차 설정">
                <label class="match-selection-tool">
                  <span>소개 주차</span>
                  <input id="matchIntroDate" type="date" />
                </label>
                <label class="match-selection-tool match-selection-tool-check">
                  <input id="matchIntroMutual" type="checkbox" />
                  <span>서로 소개로도 추가</span>
                </label>
              </div>
              <p class="match-selection-hint">
                날짜를 선택하면 해당 날짜가 속한 <strong>주차(월~일)</strong>로 “이번주 소개” 기록이 저장됩니다.
              </p>
              <p id="matchSelectionEmpty" class="match-selection-empty">아직 선택한 후보가 없습니다.</p>
              <ul id="matchSelectionList" class="match-selection-list"></ul>
            </div>
          </section>
          <section class="match-right">
            <div class="match-results-panel">
              <div class="match-results-head">
                <div class="match-results-head-actions">
                  <h4>추천 후보</h4>
                  <span id="matchScoreHint" class="match-score-hint">점수는 선호 조건 적합도입니다.</span>
                </div>
                <p id="matchStatus" class="match-status">대상자를 선택하면 추천 리스트가 표시됩니다.</p>
              </div>
              <ul id="matchResultsList" class="match-results-list"></ul>
            </div>
          </section>
          <section class="match-history">
            <div class="match-history-panel">
              <div class="match-history-head">
                <h4 id="matchHistoryTitle">대상자님의 이번주 소개</h4>
                <span id="matchHistorySummary">0명</span>
              </div>
              <div id="matchHistoryList" class="match-history-list"></div>
            </div>
          </section>
        </div>
      </div>
    </div>
    <div class="simple-modal-overlay" id="genderChartModal" hidden>
      <div class="simple-modal">
        <header class="simple-modal-header">
          <h3>성비 시각화</h3>
          <button type="button" id="genderChartCloseBtn" aria-label="성비 모달 닫기">×</button>
        </header>
        <div class="gender-chart-body">
          <div class="gender-chart-canvas">
            <canvas id="genderChartCanvas" width="320" height="320" aria-label="성비 차트"></canvas>
            <div class="gender-chart-center" id="genderChartCenter"></div>
          </div>
          <div class="gender-chart-summary" id="genderChartSummary"></div>
          <div class="gender-chart-bars" id="genderChartBars"></div>
          <div class="gender-chart-legend" id="genderChartLegend"></div>
        </div>
      </div>
    </div>
    <div class="simple-modal-overlay" id="referralChartModal" hidden>
      <div class="simple-modal referral-chart-modal">
        <header class="simple-modal-header">
          <h3>유입 경로 현황</h3>
          <button type="button" id="referralChartCloseBtn" aria-label="유입 경로 모달 닫기">×</button>
        </header>
        <div class="referral-chart-body">
          <p id="referralChartSummary" class="referral-chart-summary"></p>
          <ul id="referralChartList" class="referral-chart-list"></ul>
          <p id="referralChartEmpty" class="referral-chart-empty" hidden>표시할 데이터가 없습니다.</p>
        </div>
      </div>
    </div>
    <div class="simple-modal-overlay" id="matchedCouplesModal" hidden>
      <div class="simple-modal matched-couples-modal">
        <header class="simple-modal-header">
          <h3 id="matchedCouplesTitle">이번 주 매칭된 커플</h3>
          <button type="button" id="matchedCouplesCloseBtn" aria-label="매칭된 커플 모달 닫기">×</button>
        </header>
        <p id="matchedCouplesSubtitle" class="matched-couples-subtitle"></p>
        <div class="matched-couples-controls">
          <div class="matched-week-select">
            <label for="matchedCouplesWeekSelect">주차 선택</label>
            <select id="matchedCouplesWeekSelect" aria-label="주차별 매칭 내역"></select>
          </div>
          <div
            class="matched-week-chips"
            id="matchedCouplesWeekChips"
            role="listbox"
            aria-label="최근 주차별 매칭 내역"
          ></div>
        </div>
        <div class="matched-couples-body">
          <ul id="matchedCouplesList" class="matched-couples-list"></ul>
        </div>
      </div>
    </div>
    <div class="profile-card-overlay" id="profileCardModal" hidden>
      <div
        class="profile-card-dialog"
        role="dialog"
        aria-modal="true"
        aria-labelledby="profileCardTitle"
      >
        <header class="profile-card-header">
          <div>
            <p class="profile-card-eyebrow">Instagram Ready</p>
            <h3 id="profileCardTitle">프로필 카드 프리뷰</h3>
          </div>
          <button
            type="button"
            class="profile-card-close"
            id="profileCardCloseBtn"
            aria-label="프로필 카드 닫기"
          >
            ×
          </button>
        </header>
        <div class="profile-card-canvas-wrap">
          <div class="profile-card-preview" id="profileCardPreview" aria-live="polite"></div>
        </div>
        <p class="profile-card-hint">
          팝업을 그대로 캡처하거나 저장해 인스타 카드로 활용해 보세요.
        </p>
      </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
        <script src="dashboard.js"></script>
    </div>
  </body>
</html>


